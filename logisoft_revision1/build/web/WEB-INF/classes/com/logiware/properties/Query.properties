MAIN_SCREEN_CLIENT = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where ((acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and (acct_type like '%S%' or (acct_type like '%V%' and sub_type='Forwarder') or acct_type like '%O%' or acct_type='C')) and type <> 'master' GROUP BY acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id ORDER by tp.acct_name limit 20
MAIN_SCREEN_SHIPPER = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and (acct_type like '%S%' or (acct_type like '%V%' and sub_type = 'Forwarder')) and type <> 'master' GROUP by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id order by tp.acct_name limit 20
MAIN_SCREEN_FORWARDER = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and acct_type like '%V%' and sub_type = 'Forwarder' and type <> 'master' GROUP by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id order by tp.acct_name
MAIN_SCREEN_CONSIGNEE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and acct_type like '%C%' and type <> 'master' GROUP by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id order by tp.acct_name limit 20
MAIN_SCREEN_SSLINE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and acct_type like '%V%' and sub_type in ('Steamship Line','Air Line') GROUP by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id order by tp.acct_name limit 20
MAIN_SCREEN_AGENT = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_name like '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and acct_type like '%{1}%' GROUP by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id ORDER by tp.acct_name limit 20
MAIN_SCREEN_TERMINAL = SELECT t.terminal_location,t.trmnum FROM terminal t WHERE t.actyon IN ('Y','C','F') AND  t.terminal_location LIKE '{0}%' ORDER BY t.terminal_location LIMIT 50
IMPORT_MAIN_SCREEN_ORIGIN = SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.codedesc),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,un.statecode AS countryname,un.un_loc_code AS unlocationcode,un.id FROM un_location un JOIN genericcode_dup gc ON un.countrycode=gc.id WHERE un.un_loc_code NOT LIKE 'US%' AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%') limit 20;
IMPORT_MAIN_SCREEN_DESTINATION = SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.code),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.codedesc AS countryname,un.un_loc_code AS unlocationcode,un.id FROM un_location un JOIN genericcode_dup gc ON un.statecode=gc.id WHERE (un.un_loc_code LIKE 'PR%' OR un.un_loc_code LIKE 'US%') AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%') limit 20;
IMPORT_MAIN_SCREEN_DESTINATION_AllCITIES = SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.code),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.codedesc AS countryname,un.un_loc_code AS unlocationcode,un.id FROM un_location un JOIN genericcode_dup gc ON un.countrycode = gc.id WHERE (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%') limit 20;
SEARCH_IMPORTTERMINAL=SELECT t.terminal_location,t.trmnum FROM terminal t WHERE t.actyon='F' AND (t.trmnum LIKE '{0}%' OR t.terminal_location LIKE '%{0}%') ORDER BY t.terminal_location LIMIT 50

CLIENT_NO_CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,ic.code AS import_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE ((acct_no LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%' OR acct_type!='C')) and type <> 'master' AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_no
CLIENT_WITH_CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,ic.code AS import_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%' OR acct_type='C') AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
CLIENT_NO_CONSIGNEE_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_STATE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_STATE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_STATE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_STATE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_NO_CONSIGNEE_STATE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type!='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_STATE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder') or tp.acct_type like '%O%' or tp.acct_type='C') order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CLIENT_WITH_CONSIGNEE_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on' AND CASE WHEN COALESCE({1},'') ='' THEN ca.state LIKE '%' ELSE ca.state IN ({1}) END AND ca.zip LIKE CASE WHEN '{2}'= '' THEN '%' ELSE '{2}' END) JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) JOIN genericcode_dup sp ON (gi.sales_code = sp.id AND sp.code LIKE CASE WHEN '{3}'= '' THEN '%' ELSE '{3}' END) WHERE (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' or tp.search_acct_name like '{0}%') AND (tp.acct_type LIKE '%S%' OR (tp.acct_type LIKE '%V%' AND tp.sub_type='Forwarder') OR tp.acct_type LIKE '%O%' OR tp.acct_type='C') ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CLIENT_NO_CONSIGNEE_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,   gi.fw_fmc_no, gi.nvo_oti_license_no,  gi.poa,  cr.codedesc AS credit_status,  cy.code AS country_code,  tp.forward_account,   co.code AS coloadComNo,  co.codedesc AS coloadComDesc,  rc.code AS retailComNo,   rc.codedesc AS retailComDesc,  tp.brand_preference AS brand    FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled ,  tp.`brand_preference`, tp.`forward_account`  FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON (ca.country = cy.id) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id) WHERE ( COALESCE({1}, '') = '' OR ca.state IN ({1}) ) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND (tp.acct_type LIKE '%S%' OR (tp.acct_type LIKE '%V%' AND tp.sub_type='Forwarder') OR tp.acct_type LIKE '%O%' OR tp.acct_type!='C') ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CLIENT_WITH_CONSIGNEE_IMP = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,ic.code AS import_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND  acct_type  LIKE '%C%' AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
CLIENT_NO_CONSIGNEE_IMP = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,ic.code AS import_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE ((acct_no LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%')) AND TYPE <> 'master'  AND acct_type NOT LIKE '%C%' AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_no

COLOADER_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on' AND CASE WHEN COALESCE({1},'') ='' THEN ca.state LIKE '%' ELSE ca.state IN ({1}) END AND ca.zip LIKE CASE WHEN '{2}'= '' THEN '%' ELSE '{2}' END AND ca.city1 LIKE CASE WHEN '{3}'= '' THEN '%' ELSE '{3}%' END) JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) JOIN genericcode_dup sp ON (gi.sales_code = sp.id) WHERE (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' or tp.search_acct_name like '{0}%') AND (tp.acct_type LIKE '%S%' OR (tp.acct_type LIKE '%V%' AND tp.sub_type='Forwarder') OR tp.acct_type LIKE '%O%' OR tp.acct_type='C') ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no

SHIP_TO	= SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,ca.`unloc_code`,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE acct_name LIKE '{0}%' or search_acct_name LIKE '{0}%' AND (acct_type LIKE '%S%' OR acct_type LIKE 'C' OR (acct_type LIKE '%V%' AND sub_type='Forwarder')) GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_no
SHIPPER_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_STATE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_STATE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_STATE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and (tp.acct_type like '%S%' or (tp.acct_type like '%V%' and tp.sub_type='Forwarder')) order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
SHIPPER_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(tp.scCode, '(', tp.`scCodeDesc`, ')') AS sales_person,tp.disabled,IF(tp.coName IS NULL OR tp.coName = '', tp.address1, CONCAT(tp.coName,',','\n',tp.address1)) AS address,tp.city1 AS city,tp.state,tp.codedesc AS country,tp.zip,tp.contact_name,tp.phone,tp.fax,tp.email1, tp.fw_fmc_no,tp.nvo_oti_license_no,tp.poa, cr.codedesc AS credit_status,   tp.code AS country_code, tp.forward_account, co.code AS shpcoloadNo,  co.codedesc AS shpColoadDesc, rc.code AS shpRetailNo,  rc.codedesc AS shpRetailDesc,  ar.credit_limit AS creditLimit,  tp.brand_preference AS brand , ((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum = tp.ecifwno  AND autnot <> '*') + (SELECT COUNT(*) FROM other_db.ffnote WHERE actnum = tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f  FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account,ca.address1,ca.city1,ca.state,cy.codedesc,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,gi.id_text,cy.code,gi.id_type,gi.duns_no,sc.code AS scCode,gi.commodity_no,gi.retail_commodity,sc.`codedesc` AS scCodeDesc, tp.brand_preference,ca.`co_name` AS coName  FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on'   ) LEFT JOIN genericcode_dup cy ON (ca.country = cy.id  ) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id ) WHERE ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%'))  /* AND (tp.acct_type LIKE '%S%' OR (tp.acct_type LIKE '%V%' AND tp.sub_type='Forwarder')) */ ORDER BY tp.acct_no LIMIT 50) AS tp LEFT JOIN genericcode_dup co ON tp.commodity_no = co.id LEFT JOIN genericcode_dup rc ON tp.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
SHIPPER_NOTE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,IF(ar.import_credit='Y',CONCAT(cr.codedesc, '-', cr.id),'No Credit-') AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account,'',((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum=tp.ecifwno AND autnot <> '*')+(SELECT COUNT(*) FROM other_db.ffnote WHERE actnum=tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' or search_acct_name like '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder')) ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
SHIPPER_SS_MASTER = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,CONCAT(IF(ca.address1 IS NULL OR ca.address1 = '',' ',ca.`address1`),'', CHAR(13),IF(ca.city1 IS NULL OR ca.city1 = '',' ',CONCAT(ca.city1)), ' , ',IF(ca.state IS NULL OR ca.state = '',' ',CONCAT(ca.state)),' , ', IF(cy.codedesc IS NULL OR cy.codedesc = '',' ',CONCAT(cy.codedesc)),' ',IF(ca.zip IS NULL OR ca.zip = '',' ',CONCAT(ca.zip)),' ',CHAR(13),IF(ca.phone IS NULL OR ca.phone = '', ' ',CONCAT('PHONE:', ca.phone)),' ', CHAR(13),IF(ca.fax IS NULL OR ca.`fax` = '', ' ',CONCAT('FAX:', ca.`fax`) )) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.poa,gi.fw_fmc_no,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,ar.credit_limit,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%' OR acct_type='C') ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no

FORWARDER_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_STATE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_STATE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_STATE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Forwarder' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.commodity_no = co.id left join genericcode_dup rc on gi.retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_nos , tp.ecifwno AS bs_cons_no, tp.ssline_number, CONCAT(tp.scCode, '(', tp.`scCodeDesc`, ')') AS sales_person, tp.disabled,  IF(tp.coName IS NULL  OR tp.coName = '',  tp.address1,  CONCAT(tp.coName, ',', '\n', tp.address1)) AS address, tp.city1 AS city, tp.state, tp.codedesc AS countryCode, tp.zip, tp.contact_name, tp.phone, tp.fax, tp.email1, tp.fw_fmc_no,  tp.nvo_oti_license_no,    tp.poa,     cr.codedesc AS creditstatus,  tp.code AS country_code,   tp.forward_account,  co.code AS fwdcoloadNos, co.codedesc AS fwdColoadDescs, rc.code AS fwdRetailNo,  rc.codedesc AS fwdRetailDesc,  tp.brand_preference AS brands ,  ((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum = tp.ecifwno  AND autnot <> '*') + (SELECT COUNT(*) FROM other_db.ffnote WHERE actnum = tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f  FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account,ca.address1,ca.city1,ca.state,cy.codedesc,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,gi.id_text,cy.code,gi.id_type,gi.duns_no,gi.commodity_no,gi.retail_commodity, sc.code AS scCode,  sc.`codedesc` AS scCodeDesc, tp.brand_preference , ca.`co_name` AS coName  FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on'   ) LEFT JOIN genericcode_dup cy ON (ca.country = cy.id  ) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id ) WHERE ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND tp.acct_type LIKE '%V%' AND tp.sub_type='Forwarder' )  ORDER BY tp.acct_no LIMIT 50) AS tp LEFT JOIN genericcode_dup co ON tp.commodity_no = co.id LEFT JOIN genericcode_dup rc ON tp.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no

CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,ar.credit_limit,tp.forward_account  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' or search_acct_name like '{0}%') AND acct_type LIKE '%C%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CONSIGNEE_BL = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,ar.credit_limit,tp.forward_account  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' or search_acct_name like '{0}%') AND acct_type LIKE '%C%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CONSIGNEE_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_STATE_ZIP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_STATE_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_STATE_ZIP_SP = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no,ar.credit_limit from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1}) and ca.zip = {2}) join cust_general_info gi on (tp.acct_no = gi.acct_no) join genericcode_dup sp on (gi.sales_code = sp.id and sp.code = '{3}') where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%C%' order by tp.acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CONSIGNEE_SEARCH= SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(tp.scCode, '(', tp.`scCodeDesc`, ')') AS sales_person,tp.disabled,IF(tp.coName IS NULL OR tp.coName = '', tp.address1, CONCAT(tp.coName,',','\n',tp.address1)) AS address,tp.city1 AS city,tp.state,tp.codedesc AS country,tp.zip,tp.contact_name,tp.phone,tp.fax,tp.email1, tp.fw_fmc_no,  tp.nvo_oti_license_no,    tp.poa,  cr.codedesc AS credit_status,  tp.code AS country_code, ar.credit_limit,    tp.forward_account, co.code AS consColoadNo,  co.codedesc AS consColoadDesc, rc.code AS consRetailNo,  rc.codedesc AS consRetailDesc, ((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum = tp.ecifwno  AND autnot <> '*') + (SELECT COUNT(*) FROM other_db.ffnote WHERE actnum = tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f  FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account,ca.address1,ca.city1,ca.state,cy.codedesc,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,gi.id_text,cy.code,gi.id_type,gi.duns_no,    sc.code AS scCode, sc.`codedesc` AS scCodeDesc, tp.brand_preference , gi.cons_coload_commodity,gi.cons_retail_commodity,ca.`co_name` AS coName  FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on'   ) LEFT JOIN genericcode_dup cy ON (ca.country = cy.id  ) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id ) WHERE ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND tp.acct_type LIKE '%C%')  ORDER BY tp.acct_no LIMIT 50) AS tp LEFT JOIN genericcode_dup co ON tp.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON tp.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CONSIGNEE_NOTE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',' ,'\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,IF(ar.import_credit = 'Y',cr.codedesc,'No Credit') AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,ar.credit_limit,tp.forward_account,'',((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum=tp.ecifwno AND autnot <> '*')+(SELECT COUNT(*) FROM other_db.ffnote WHERE actnum=tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f,ar.import_credit  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' or search_acct_name like '{0}%') AND acct_type LIKE '%C%' AND acct_type NOT LIKE '%Z%' ORDER BY acct_no LIMIT 50) AS tp LEFT JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
CONSIGNEE_SS_MASTER =SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,CONCAT(IF(ca.address1 IS NULL OR ca.address1 = '',' ',ca.`address1`), ', ', IF(ca.city1 IS NULL OR ca.city1 = '', ' ',CONCAT('City:', ca.city1)),' ',IF(cy.codedesc IS NULL OR cy.codedesc = '' , ' ',CONCAT('Country:', cy.codedesc)),' ',IF(ca.phone IS NULL OR ca.phone  = '', ' ',CONCAT('PH#:', ca.phone))) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,ar.credit_limit,tp.forward_account  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND acct_type LIKE '%C%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no

TRADING_PARTNER = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where ((acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%')  and (acct_type like '%S%' or (acct_type like '%V%' and sub_type='Forwarder') or acct_type like '%O%' or acct_type='C')) order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
TRADING_PARTNER_IMPORTS = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
AGENT = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,tp.forward_account,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') and acct_type like '%{1}%' order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
THIRD_PARTY = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account,'' as a,'' as b,'' as c,'' as d,'' as e,ar.import_credit FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
THIRD_PARTY_SEARCH= SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,co.code AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on' AND CASE WHEN COALESCE({1},'') ='' THEN ca.state LIKE '%' ELSE ca.state IN ({1}) END AND ca.zip LIKE CASE WHEN '{2}'= '' THEN '%' ELSE '{2}' END) WHERE (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND tp.acct_type LIKE '%C%' ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
#THIRD_PARTY_BL= SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account,'' AS a,'' AS b,'' AS c,'' AS d,'' AS e,ar.import_credit FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND (acct_type  LIKE '%S%' OR (acct_type  LIKE '%v%' AND sub_type='Forwarder') OR acct_type LIKE '%E%') AND acct_type NOT LIKE 'Z' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
THIRD_PARTY_BL=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,cr.codedesc AS creditStatus,ar.credit_limit AS creditAmt,cy.code AS country_code,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%v%' AND sub_type = 'Forwarder') OR acct_type LIKE '%E%') AND acct_type NOT LIKE 'Z' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
THIRD_PARTY_BL_FILTER=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,cr.codedesc AS creditStatus,ar.credit_limit AS creditAmt,cy.code AS country_code,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE ((acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%v%' AND sub_type = 'Forwarder') OR acct_type LIKE '%E%') AND acct_type NOT LIKE 'Z') GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id where ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}')  AND ('{4}' = '' OR cy.code = '{4}')) ORDER BY tp.acct_name
FORWARDER_BL = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,cr.codedesc as credit_status,ar.credit_limit,tp.forward_account from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') and (acct_type like '%S%' or (acct_type like '%V%' and sub_type='Forwarder') or acct_type like '%O%' or acct_type='C') order by acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
FORWARDER_BL_FILTER=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,tp.scCode AS sales_person,tp.disabled,IF(tp.coName IS NULL OR tp.coName = '', tp.address1, CONCAT(tp.coName,',','\n',tp.address1)) AS address,tp.city1 AS city,tp.state,tp.codedesc AS country,tp.zip,tp.contact_name,tp.phone,tp.fax,tp.email1,tp.fw_fmc_no,cr.codedesc AS credit_status,ar.credit_limit,tp.forward_account FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account,ca.address1,ca.city1,ca.state,cy.codedesc,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,cy.code,sc.code AS scCode,ca.`co_name` AS coName FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON (ca.country = cy.id) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id) WHERE ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND tp.acct_type LIKE '%V%' AND tp.sub_type = 'Forwarder') ORDER BY tp.acct_no LIMIT 50) AS tp LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
VENDOR = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,tp.forward_account  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND acct_type LIKE '%V%' AND acct_type NOT LIKE '%Z%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON tp.acct_no = ca.acct_no AND ca.prime='on' LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id GROUP BY tp.acct_no
VENDOR_SEARCH = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,tp.scCode AS sales_person,tp.disabled,tp.address1 AS address,tp.city1 AS city,tp.state,tp.codedesc AS country,tp.zip,tp.contact_name,tp.phone,tp.fax,tp.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,tp.fw_fmc_no,tp.nvo_oti_license_no,tp.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,tp.id_text,tp.code AS country_code,tp.id_type,tp.duns_no,tp.forward_account,'',((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum = tp.ecifwno  AND autnot <> '*') + (SELECT COUNT(*) FROM other_db.ffnote WHERE actnum = tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no = tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f  FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account,ca.address1,ca.city1,ca.state,cy.codedesc,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,gi.id_text,cy.code,gi.id_type,gi.duns_no,sc.code AS scCode,gi.commodity_no,gi.retail_commodity FROM trading_partner tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on'   ) LEFT JOIN genericcode_dup cy ON (ca.country = cy.id  ) LEFT JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no) LEFT JOIN genericcode_dup sc ON (gi.sales_code = sc.id ) WHERE ((COALESCE({1}, '') = '' OR ca.state IN ({1})) AND ('{2}' = '' OR ca.zip = '{2}') AND ('{3}' = '' OR sc.code = '{3}') AND ('{4}' = '' OR cy.code = '{4}') AND (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') AND tp.acct_type LIKE '%V%')  ORDER BY tp.acct_no LIMIT 50) AS tp LEFT JOIN genericcode_dup co ON tp.commodity_no = co.id LEFT JOIN genericcode_dup rc ON tp.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
IMPORT_CFS = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.phone,ca.state,cy.codedesc as country,ca.zip,ca.fax,ca.co_name as coName,tp.firms_code as firmsCode from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,firms_code from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' OR search_acct_name LIKE '{0}%') and acct_type like '%V%' and sub_type='Import CFS' order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
IMPORT_CFS_STATE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.phone,ca.state,cy.codedesc as country,ca.zip,ca.fax,ca.co_name as coName,tp.firms_code as firmsCode from (select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.firms_code from trading_partner tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on' and ca.state in ({1})) where (tp.acct_no like '{0}%' or tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%') and tp.acct_type like '%V%' and tp.sub_type='Import CFS' order by tp.acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
IMPORT_SSLINE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') and acct_type like '%V%' and sub_type = 'Steamship Line' order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
CLIENT = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.poa,gi.fw_fmc_no,concat(cr.codedesc, '-', cr.id) as credit_status,ar.credit_limit,tp.forward_account from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') and (acct_type like '%S%' or (acct_type like '%V%' and sub_type='Forwarder') or acct_type like '%O%' or acct_type='C') order by acct_no limit 50) as tp join cust_address ca on (tp.acct_no = ca.acct_no and ca.prime = 'on') left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id group by tp.acct_no
CFCL_ACCOUNT = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,tp.forward_account,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip FROM (SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account  FROM trading_partner tp JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no AND gi.cfcl_account = 'Y') WHERE (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON tp.acct_no = ca.acct_no AND ca.prime='on' LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id GROUP BY tp.acct_no
CFCL_ACCOUNTNO=SELECT tp.acct_no,tp.acct_name,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,tp.forward_account,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip FROM(SELECT tp.acct_no,tp.acct_name,tp.acct_type,tp.sub_type,tp.eci_acct_no,tp.ecifwno,tp.ssline_number,tp.disabled,tp.forward_account FROM trading_partner tp JOIN cust_general_info gi ON (tp.acct_no = gi.acct_no AND gi.cfcl_account = 'Y')WHERE (tp.acct_no LIKE '{0}%' OR tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%') ORDER BY tp.acct_no LIMIT 50) AS tp JOIN cust_address ca ON tp.acct_no = ca.acct_no AND ca.prime = 'on'  LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id GROUP BY tp.acct_no
TP_IMPORTS_NOTE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,IF(ar.import_credit='Y',cr.codedesc,'No Credit') AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account,'',((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum=tp.ecifwno AND (autnot = 'I' OR autnot = 'G'))+(SELECT COUNT(*) FROM other_db.ffnote WHERE actnum=tp.eci_acct_no AND (autnot = 'I' OR autnot = 'G'))) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f ,IF(scan.id IS NOT NULL ,'SOP','') AS scan_Sop,ar.import_credit FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp LEFT JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id LEFT JOIN document_store_log scan ON scan.`Document_ID`=tp.acct_no AND scan.screen_name = 'TRADINGPARTNER' AND scan.document_name = 'SOP' ORDER BY tp.acct_name

PORT = select concat(upper(un.un_loc_name),'/',ifnull(upper(p.statecode),''),'(', un.un_loc_code,')') as location,upper(un.un_loc_name) as port_name,p.statecode as state_code,un.un_loc_code  as un_location_code,un.id as id from un_location un join lcl_relay_poo lrp on (un.id = lrp.poo_id and lrp.active = true) join ports p on un.un_loc_code = p.unlocationcode where (un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%') group by un.un_loc_code limit 50
PORT_ECULINE = select un.un_loc_code  as un_location_code,concat(upper(un.un_loc_name),'/',ifnull(upper(p.statecode),''),'(', un.un_loc_code,')') as location,upper(un.un_loc_name) as port_name,p.statecode as state_code,un.id as id from un_location un join ports p on un.un_loc_code = p.unlocationcode where (un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%') group by un.un_loc_code limit 50

TRADING_AGENT=SELECT tp.acct_name,tp.acct_no,tp.acct_type AS acctType,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,a.lcl_agent_level_brand FROM trading_partner tp JOIN cust_address ca ON tp.acct_no = ca.acct_no JOIN  agency_info a ON a.agentid=tp.acct_no JOIN ports p ON p.id = a.schnum LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN genericcode_dup ag ON gi.`imp_comm_no` = ag.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id WHERE (tp.acct_name LIKE '{0}%' OR tp.search_acct_name LIKE '{0}%' OR a.agentid LIKE '{0}%') AND p.unlocationcode = '{1}' AND a.type='L' GROUP BY tp.acct_no
TRADING_AGENT_BL=SELECT tp.acct_name,tp.acct_no,ca.address1,ca.phone,ca.fax,ca.email1 FROM agency_info a,ports p, trading_partner tp LEFT JOIN cust_address ca ON ca.acct_no=tp.acct_no WHERE tp.acct_name LIKE '{0}%' or tp.search_acct_name like '{0}%' AND tp.acct_no=a.agentid AND p.unlocationcode='{1}' AND p.id=a.schnum AND a.type='L' LIMIT 50
FOREIGNAGENT = SELECT tp.acct_name,tp.acct_no,tp.acct_type,ca.contact_name,ca.phone,ca.fax,ca.email1,ca.address1,ca.city1,g.codedesc,ca.state,ca.zip,tp.sub_type FROM trading_partner tp, cust_address ca LEFT JOIN genericcode_dup g ON g.id=ca.country WHERE ca.acct_no=tp.acct_no AND ca.prime = 'on' AND (tp.acct_name LIKE '{0}%' or tp.search_acct_name like '{0}%' or tp.acct_no LIKE '{0}%') GROUP BY tp.acct_no LIMIT 100
IMPORTORIGINAGENT=SELECT tp.acct_name,tp.acct_no,tp.acct_type as acctType,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,CONCAT(co.code, ' ', co.codedesc) AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,ag.`code` AS agCommodityNo FROM trading_partner tp JOIN cust_address ca ON tp.acct_no = ca.acct_no JOIN  agency_info a ON a.agentid=tp.acct_no JOIN ports p ON p.id = a.schnum LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN genericcode_dup ag ON gi.`imp_comm_no` = ag.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id WHERE (tp.acct_name LIKE '{0}%' or tp.search_acct_name like '{0}%' OR a.agentid LIKE '{0}%')  AND tp.acct_type NOT LIKE '%Z%' AND p.unlocationcode = '{1}' AND a.type='I' GROUP BY tp.acct_no

PORT_NAME = select upper(p.portname), upper(p.countryname),p.unlocationcode, p.id,p.`govschnum` from ports p where (p.portname like '{0}%' or p.unlocationcode like '{0}%' or p.search_port_name like '{0}%') group by p.portname order by p.portname limit 10
ISSUEING_TERMINAL = select tm.terminal_location, tm.ledger_no,tm.trmnam, tm.addres1 from terminal tm  where tm.actyon='Y' and tm.terminal_location  like '{0}%' order by tm.terminal_location limit 50
SALES_PERSON = select upper(login_name), user_id from user_details where status='ACTIVE' and (first_name like '{0}%' OR login_name like '{0}%') limit 100
BL_PERSON = select upper(login_name), user_id from user_details where status='ACTIVE' and (first_name like '{0}%' or login_name like '{0}%') limit 50
USER_NAME = select first_name,last_name,user_id,login_name from user_details where first_name like '{0}%' limit 50
COMMODITY_TYPE_NAME = select upper(ct.desc_en),ct.code,ct.hazmat,ct.id from commodity_type ct where (ct.desc_en like '%{0}%' or ct.code like '%{0}%') group by ct.desc_en order by ct.desc_en limit 100
COMMODITY_TYPE_NAME_BOOK = select upper(ct.desc_en),ct.code,ct.hazmat,ct.id from commodity_type ct where (ct.desc_en like '{0}%' or ct.code like '{0}%') and ct.code!=032500 group by ct.desc_en order by ct.desc_en limit 100
COMMODITY_TYPE_CODE = select ct.code, upper(ct.desc_en),ct.hazmat,ct.id from commodity_type ct where (ct.desc_en like '{0}%' or ct.code like '{0}%') group by ct.desc_en order by ct.desc_en limit 50
PACKAGE_TYPE = select upper(pt.description), upper(pt.type), pt.abbr01, pt.id from package_type pt where pt.description like '{0}%' group by pt.description order by pt.description limit 10
COMMODITY_PACKAGE_TYPE = select upper(pt.description), upper(pt.type), pt.abbr01, pt.id from package_type pt where pt.description like '{0}%' group by pt.description order by pt.description 
HOTCODE_TYPE = select gc.code,upper(gc.codedesc),gc.codetypeid,gc.id from genericcode_dup gc where gc.codedesc like '{0}%' and gc.codetypeid=57 group by gc.codedesc order by gc.codedesc limit 50
PACKAGE_TYPE1 = select pt.description, pt.abbr01, pt.id from package_type pt where pt.description like '{0}%' group by pt.description order by pt.description limit 50
PACK_TYPE = select upper(gc.codedesc),gc.code,gc.codetypeid,gc.id from genericcode_dup gc where gc.codedesc like '{0}%' and gc.codetypeid=50 group by gc.codedesc order by gc.codedesc limit 50
CITY_NAME = select zip,city,state from zip_code where (city like '{0}%' or zip like '{0}%') limit 50
CONCAT_PORT_NAME = select concat(upper(p.portname),'/', ifnull(upper(gd.code),upper(g.codedesc)),'(', p.unlocationcode,')') as location,upper(p.portname), upper(p.countryname), p.unlocationcode,p.id from ports p left join un_location u1 on u1.id=p.id left join genericcode_dup g on g.id=u1.countrycode left join genericcode_dup gd on gd.id=u1.statecode  where (p.portname like '{0}%' or p.unlocationcode like '{0}%' or p.search_port_name like '{0}%') group by location order by p.portname limit 100
CONCAT_HOTCODE_TYPE = select concat(gc.code,'/',upper(gc.codedesc)) as description,gc.code,upper(gc.codedesc),gc.codetypeid,gc.id,gc.field1 from genericcode_dup gc where (gc.codedesc like '%{0}%' or gc.code like '{0}%') and gc.codetypeid='57' group by description order by gc.codedesc limit 50
CONCAT_RELAY_NAME_FD = select concat(upper(ul.un_loc_name),'/',ifnull(upper(gd.code),upper(gc.codedesc)),'(',ul.un_loc_code,')'),upper(ul.un_loc_name) as portname,gc.codedesc as countryname,ul.un_loc_code as unlocationcode,ul.id from un_location ul join lcl_relay_fd lrf on ul.id = lrf.fd_id join genericcode_dup gc on ul.countrycode = gc.id left join genericcode_dup gd on ul.statecode = gd.id where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') group by ul.un_loc_code limit 1000
CONCAT_CITY_DEST=select concat(upper(ul.un_loc_name),'/',ifnull(upper(gd.code),upper(gc.codedesc)),'(',ul.un_loc_code,')'),upper(ul.un_loc_name) as portname,gc.codedesc as countryname,ul.un_loc_code as unlocationcode,ul.id from un_location ul join genericcode_dup gc on ul.countrycode = gc.id left join genericcode_dup gd on ul.statecode = gd.id where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') group by ul.un_loc_code limit 1000
CONCAT_CITY = select concat(zip,'-',city,'/',state),zip,city,state,id from zip_code where (city like '{0}%' or zip like '{0}%') order by state,city limit 50
PORTNAME = select concat(upper(p.portname),'/',ifnull(upper(p.statecode),g1.codedesc),'(',p.unlocationcode,')'),upper(p.portname),upper(p.statecode),p.unlocationcode,p.id from ports p left join un_location u1 on u1.`un_loc_code`=p.unlocationcode left join genericcode_dup g1 on u1.`countrycode`=g1.id where (p.portname like '{0}%' or p.unlocationcode like '{0}%' or p.search_port_name like '{0}%') group by p.portname order by p.portname limit 50
ORIGIN_UNLOC = select concat(upper(un.un_loc_name),'/',ifnull(upper(st.code),upper(ct.codedesc)),'(',un.un_loc_code,')'),upper(un.un_loc_name),upper(un.statecode),un.un_loc_code,un.id from un_location un left join genericcode_dup st on st.id=un.statecode and st.Codetypeid=10 left join genericcode_dup ct on ct.id=un.countrycode and ct.Codetypeid=11 where un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%' group by un.un_loc_code order by un.un_loc_name limit 50
ORIGIN_UNLOC_ECULINE = select un.un_loc_code,concat(upper(un.un_loc_name),'/',ifnull(upper(st.code),upper(ct.codedesc)),'(',un.un_loc_code,')'),upper(un.un_loc_name),upper(un.statecode),un.id from un_location un left join genericcode_dup st on st.id=un.statecode and st.Codetypeid=10 left join genericcode_dup ct on ct.id=un.countrycode and ct.Codetypeid=11 where un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%' group by un.un_loc_code order by un.un_loc_name limit 50
DEST_UNLOC = select concat(upper(un.un_loc_name),'/',ifnull(upper(st.code),upper(ct.codedesc)),'(',un.un_loc_code,')'),upper(un.un_loc_name),upper(un.statecode),un.un_loc_code,un.id from un_location un left join genericcode_dup st on st.id=un.statecode and st.codetypeid=10 left join genericcode_dup ct on ct.id=un.countrycode and ct.codetypeid=11 where (un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%') and (un.un_loc_code like 'us%' or un.un_loc_code like 'ca%') group by un.un_loc_code order by un.un_loc_name limit 1000
RELAYNAME = select concat(upper(ul.un_loc_name),'/',ifnull(upper(p.statecode),''),'(', ul.un_loc_code,')'),upper(ul.un_loc_name) as portname,p.statecode as statecode,ul.un_loc_code  as unlocationcode,ul.id from lcl_relay_poo lrp inner join un_location ul on lrp.poo_id=ul.id inner join ports p on ul.un_loc_code=p.unlocationcode where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') and lrp.active = true group by ul.un_loc_code limit 50
RELAYNAME_DOMESTIC_INLAND = select concat(upper(ul.un_loc_name),'/',ifnull(upper(p.statecode),''),'(', ul.un_loc_code,')'),upper(ul.un_loc_name) as portname,p.statecode as statecode,ul.un_loc_code  as unlocationcode,ul.id from lcl_relay_poo lrp inner join un_location ul on lrp.poo_id=ul.id inner join ports p on ul.un_loc_code=p.unlocationcode where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') and (ul.un_loc_code like 'us%' or ul.un_loc_code like 'ca%' or ul.un_loc_code LIKE 'pr%') and lrp.active = true group by ul.un_loc_code limit 50
CHARGE_CODE= SELECT gl.charge_code AS cost_code,IF(gl.charge_description <> '',gl.charge_description,ge.codedesc) AS description,gl.id ,gl.`bluescreen_chargecode` FROM gl_mapping gl JOIN genericcode_dup ge ON gl.charge_code = ge.code AND ge.codetypeid = (SELECT codetypeid FROM codetype WHERE description = 'Cost Code') WHERE gl.charge_code <> '' AND gl.bluescreen_chargecode <> '' AND (gl.charge_code LIKE '{0}%' OR gl.charge_description LIKE '{0}%' OR ge.codedesc LIKE '{0}%') AND gl.shipment_type='{1}' AND gl.Transaction_Type='AR'  GROUP BY gl.charge_code ORDER BY gl.charge_code
CHARGE_COST_CODE= SELECT gl.charge_code AS cost_code,IF(gl.charge_description <> '',gl.charge_description,ge.codedesc) AS description,gl.id ,gl.`bluescreen_chargecode` FROM gl_mapping gl JOIN genericcode_dup ge ON gl.charge_code = ge.code AND ge.codetypeid = (SELECT codetypeid FROM codetype WHERE description = 'Cost Code') WHERE gl.charge_code <> '' AND (gl.charge_code LIKE '%{0}%' OR gl.charge_description LIKE '%{0}%') AND gl.shipment_type='{1}' GROUP BY gl.charge_code ORDER BY gl.charge_code
COST_CODE= SELECT gl.charge_code AS cost_code,IF(gl.charge_description <> '',gl.charge_description,ge.codedesc) AS description,gl.id ,gl.`bluescreen_chargecode` FROM gl_mapping gl JOIN genericcode_dup ge ON gl.charge_code = ge.code AND ge.codetypeid = (SELECT codetypeid FROM codetype WHERE description = 'Cost Code') WHERE gl.charge_code <> '' AND gl.bluescreen_chargecode <> '' AND (gl.charge_code LIKE '{0}%' OR gl.charge_description LIKE '{0}%') AND gl.shipment_type='{1}' AND gl.Transaction_Type='AC' GROUP BY gl.charge_code ORDER BY gl.charge_code
COST_CODE_UNIT=SELECT gl.charge_code AS cost_code,IF(gl.charge_description <> '',gl.charge_description,ge.codedesc) AS description,gl.id ,gl.`bluescreen_chargecode` FROM gl_mapping gl JOIN genericcode_dup ge ON gl.charge_code = ge.code AND ge.codetypeid = (SELECT codetypeid FROM codetype WHERE description = 'Cost Code') WHERE gl.charge_code <> '' AND gl.bluescreen_chargecode <> '' AND (gl.charge_code LIKE '{0}%' OR gl.charge_description LIKE '{0}%' OR ge.codedesc LIKE '{0}%') AND gl.shipment_type='{1}' AND gl.Transaction_Type='AC' GROUP BY gl.charge_code ORDER BY gl.charge_code
CONCAT_TERM_BL=SELECT CONCAT(t.terminal_location,'/',t.trmnum),t.terminal_location,t.trmnum,t.trmnam FROM terminal t WHERE t.trmnum LIKE '{0}%' OR t.terminal_location LIKE '%{0}%' ORDER BY t.terminal_location LIMIT 50
TERM_BL=SELECT CONCAT(t.terminal_location,'/',t.trmnum),t.terminal_location,t.trmnum,t.trmnam FROM terminal t WHERE actyon IN ('Y','C','F') AND (t.trmnum LIKE '{0}%' OR t.terminal_location LIKE '%{0}%') ORDER BY t.terminal_location LIMIT 50
PICKUP=SELECT warehsname,address,warehsno,CONCAT(whse.address,'\n',whse.city,',',whse.state,'-',whse.zipcode),whse.phone,whse.fax FROM warehouse whse WHERE warehouse_type='LCLE' AND (warehsname LIKE '{0}%' OR warehsno LIKE '{0}%') LIMIT 100
PICKUPFORQUOTE=SELECT warehsname,address,warehsno,CONCAT(whse.address,'\n',whse.city,',',whse.state),whse.phone,whse.fax,whse.zipcode FROM warehouse whse WHERE warehouse_type='LCLE' AND (warehsname LIKE '{0}%' OR warehsno LIKE '{0}%') LIMIT 100
DELWHSE=SELECT concat(wh.warnam,' - ',wh.warnum),wh.warnam,wh.warnum,wh.state,wh.zipcod,wh.addres,wh.phone,wh.city FROM other_db.warehs wh WHERE (wh.warnum LIKE '{0}%' OR wh.warnam LIKE '{0}%') and wh.warnum LIKE '{0}%' LIMIT 50
INVOICE_CHARGE_CODE=SELECT gl.charge_code AS cost_code,IF(gl.charge_description <> '',gl.charge_description,ge.codedesc) AS description,gl.id FROM gl_mapping gl JOIN genericcode_dup ge ON gl.charge_code = ge.code AND ge.codetypeid = (SELECT codetypeid FROM codetype WHERE description = 'Cost Code') WHERE gl.charge_code <> '' AND (gl.charge_code LIKE '{0}%' OR gl.charge_description LIKE '{0}%') AND gl.shipment_type='{1}' GROUP BY gl.charge_code ORDER BY gl.charge_code
RELAYNAME_FD=SELECT DISTINCT  CONCAT(UPPER(ul.un_loc_name),'/',UPPER(gc.codedesc),'(',ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname,gc.codedesc AS countryname,ul.un_loc_code AS unlocationcode,gc.code,ul.id FROM lcl_relay_fd lrf INNER JOIN un_location ul ON lrf.fd_id=ul.id INNER JOIN genericcode_dup gc ON ul.countrycode=gc.id WHERE ul.un_loc_name LIKE '{0}%' or ul.search_un_loc_name like '{0}%' GROUP BY ul.un_loc_code LIMIT 50
CONCAT_CITY_NAME=SELECT DISTINCT  CONCAT(UPPER(ul.un_loc_name),'/',UPPER(gc.codedesc),'(',ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname,gc.codedesc AS countryname,ul.un_loc_code AS unlocationcode,ul.id FROM lcl_relay_fd lrf  INNER JOIN un_location ul ON lrf.fd_id=ul.id INNER JOIN genericcode_dup gc ON ul.countrycode=gc.id WHERE (gc.codedesc LIKE '{0}%' OR ul.un_loc_code LIKE '{0}%') GROUP BY ul.un_loc_code LIMIT 1000
PACKAGE_TYPE_PLURAL=SELECT DISTINCT CONCAT(UPPER(pt.description),pt.plural) AS description,UPPER(pt.type),pt.abbr01,pt.id FROM package_type pt WHERE CONCAT(pt.description,pt.plural) LIKE "{0}%" ORDER BY pt.description
LCL_SCHEDULE_ORIGIN=SELECT CONCAT(UPPER(p.portname),'/',UPPER(p.countryname),'(',p.unlocationcode,')'), UPPER(p.portname), UPPER(p.countryname),p.unlocationcode, p.id FROM ports p WHERE (p.portname LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' or p.search_port_name like '{0}%') ORDER BY p.portname LIMIT 10
ISSUING_TERMINAL=SELECT CONCAT(t.terminal_location,'/',t.trmnum),t.terminal_location,t.trmnum,t.trmnam FROM terminal t WHERE (t.trmnum LIKE '{0}%' OR t.terminal_location LIKE '{0}%') AND t.actyon='Y' ORDER BY t.terminal_location LIMIT 50
GENERICCODE_BY_CODETYPEID=SELECT codedesc FROM genericcode_dup WHERE codetypeid = '{1}' AND codedesc LIKE '{0}%' ORDER BY codedesc LIMIT 100
WAREHOUSE=SELECT wh.warehsname,wh.warehsno,wh.address,wh.id,wh.city,wh.state,wh.zipcode,wh.phone FROM warehouse wh WHERE wh.warehsname LIKE '{0}%' or wh.warehsno like '{0}%' ORDER BY wh.warehsname LIMIT 100
SEARCH_DESTINATION= SELECT DISTINCT CONCAT(UPPER(p.portname),'/',IFNULL(UPPER(p.statecode),''),'(',p.unlocationcode,')'),UPPER(p.portname),UPPER(p.statecode),p.unlocationcode,p.id FROM ports p  WHERE (p.portname LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' or p.search_port_name like '{0}%') ORDER BY p.portname LIMIT 10
RELAYORIGIN = SELECT DISTINCT CONCAT(poo_unloc.un_loc_name,'/',gd.code,'(',poo_unloc.un_loc_code,')'),poo_unloc.un_loc_name AS `poo_name`,gd.code as state,poo_unloc.un_loc_code AS `poo_code`,lcl_relay_poo.poo_id AS `poo_id` FROM lcl_relay_poo, lcl_relay_fd, lcl_relay, un_location poo_unloc, un_location pol_unloc, un_location pod_unloc, un_location fd_unloc,`genericcode_dup` gd  WHERE lcl_relay_poo.active = TRUE AND lcl_relay_fd.fd_id = '{1}' AND lcl_relay_fd.active = TRUE AND lcl_relay_fd.relay_id = lcl_relay_poo.relay_id AND lcl_relay.id = lcl_relay_poo.relay_id AND lcl_relay.active = TRUE AND NOT EXISTS (SELECT lcl_relay_exception.id FROM lcl_relay_exception WHERE lcl_relay_exception.poo_id = lcl_relay_poo.poo_id AND  lcl_relay_exception.pol_id = lcl_relay.pol_id AND  lcl_relay_exception.pod_id = lcl_relay.pod_id AND  lcl_relay_exception.fd_id = lcl_relay_fd.fd_id AND lcl_relay_exception.active = TRUE) AND poo_unloc.id = lcl_relay_poo.poo_id AND pol_unloc.id = lcl_relay.pol_id AND pod_unloc.id = lcl_relay.pod_id AND fd_unloc.id = lcl_relay_fd.fd_id AND gd.id=poo_unloc.statecode AND ( poo_unloc.un_loc_name LIKE '{0}%' or poo_unloc.search_un_loc_name LIKE '{0}%' ) LIMIT 50;
RELAYDESTINATION = SELECT DISTINCT CONCAT(UPPER(fd_unloc.un_loc_name),'/',gd.codedesc,'(',fd_unloc.un_loc_code,')'),fd_unloc.un_loc_name AS `poo_name`,gd.codedesc as country,fd_unloc.un_loc_code AS `poo_code`,lcl_relay_fd.`fd_id` AS `fd_id` FROM lcl_relay_poo, lcl_relay_fd, lcl_relay, un_location poo_unloc, un_location pol_unloc, un_location pod_unloc, un_location fd_unloc,`genericcode_dup` gd WHERE lcl_relay_poo.active = TRUE AND lcl_relay_poo.`poo_id` = '{1}' AND lcl_relay_fd.active = TRUE AND lcl_relay_fd.relay_id = lcl_relay_poo.relay_id AND lcl_relay.id = lcl_relay_poo.relay_id AND lcl_relay.active = TRUE AND NOT EXISTS (SELECT lcl_relay_exception.id FROM lcl_relay_exception WHERE lcl_relay_exception.poo_id = lcl_relay_poo.poo_id AND  lcl_relay_exception.pol_id = lcl_relay.pol_id AND  lcl_relay_exception.pod_id = lcl_relay.pod_id AND  lcl_relay_exception.fd_id = lcl_relay_fd.fd_id AND lcl_relay_exception.active = TRUE) AND poo_unloc.id = lcl_relay_poo.poo_id AND pol_unloc.id = lcl_relay.pol_id AND pod_unloc.id = lcl_relay.pod_id AND fd_unloc.id = lcl_relay_fd.fd_id AND gd.id=fd_unloc.countrycode AND (fd_unloc.un_loc_name LIKE '{0}%' OR fd_unloc.search_un_loc_name LIKE '{0}%' OR fd_unloc.un_loc_code LIKE '{0}%') LIMIT 500;
UNLOCATION = SELECT DISTINCT CONCAT((un.un_loc_name),'/',IFNULL((st.code),(ct.codedesc)),'(',un.un_loc_code,')'),un.un_loc_name,un.statecode,un.un_loc_code,un.id FROM un_location un LEFT JOIN genericcode_dup st ON st.id=un.statecode AND st.Codetypeid=10 LEFT JOIN genericcode_dup ct ON ct.id=un.countrycode AND ct.Codetypeid=11 WHERE un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%' ORDER BY un.un_loc_name LIMIT 50
UNLOCATIONCODE = SELECT CONCAT(UPPER(un.un_loc_name), IF(p.statecode <> '' OR NULL ,CONCAT(',',UPPER(p.statecode)), '')) AS location from un_location un join lcl_relay_poo lrp on (un.id = lrp.poo_id and lrp.active = true) join ports p on un.un_loc_code = p.unlocationcode where (un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or un.un_loc_code like '{0}%') group by un.un_loc_code limit 50
CONCAT_COUNTRY_NAME=SELECT DISTINCT CONCAT(UPPER(ul.un_loc_name),'/',IFNULL(UPPER(gd.code),UPPER(gc.codedesc)),'(',ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname,gc.codedesc AS countryname,ul.un_loc_code AS unlocationcode,ul.id FROM lcl_relay_fd lrf  INNER JOIN un_location ul ON lrf.fd_id=ul.id INNER JOIN genericcode_dup gc ON ul.countrycode=gc.id LEFT JOIN genericcode_dup gd ON ul.statecode=gd.id WHERE gc.codedesc LIKE '{0}%' GROUP BY ul.un_loc_code LIMIT 1000
CONTACT = SELECT DISTINCT CONCAT(first_name,' ',last_name),email,fax,phone FROM cust_contact WHERE first_name LIKE '{0}%' LIMIT 50
CONTACTFORACCT = SELECT DISTINCT CONCAT(first_name,' ',last_name),email,fax,phone FROM cust_contact WHERE acct_no='{1}' and first_name LIKE '{0}%'
SSCHEDULENO = SELECT code,codedesc FROM genericcode_dup WHERE codetypeid='68' AND code LIKE '{0}%' LIMIT 50
SSCHEDULENAME = SELECT codedesc,code FROM genericcode_dup WHERE codetypeid='68' AND codedesc LIKE '{0}%' LIMIT 50
WHSCODE=SELECT wh.warnum,wh.warnam,CONCAT(wh.warnam,',','\n',wh.addres,',','\n',wh.city,',',wh.state,'-',wh.zipcod,'\nPhone:',wh.phone,'\nFax:',wh.whsfax) FROM other_db.warehs wh WHERE (wh.warnum LIKE '{0}%' OR wh.warnam LIKE '{0}%') AND wh.warnum LIKE 'W%' LIMIT 50
DETAILWHSE = SELECT warehsname,warehsno,id  FROM warehouse where warehsname like '{0}%' or warehsno like '{0}%' LIMIT 50

COMMODITYTYPEFORRATES = SELECT ct.desc_en,ct.code,ct.hazmat,ct.id FROM other_db.ofrate  ofr left JOIN  commodity_type ct ON ofr.comcde = ct.code WHERE ofr.oabcod!='A' and ofr.trmnum = '{1}' AND ofr.prtnum = '{2}' and (ct.desc_en like '%{0}%' or ct.code like '%{0}%') ORDER BY ct.desc_en limit 100
COMMODITYCODEFORRATES = SELECT ct.code,ct.desc_en,ct.hazmat,ct.id FROM other_db.ofrate  ofr left JOIN  commodity_type ct ON ofr.comcde = ct.code WHERE ofr.oabcod!='A' and ofr.trmnum = '{1}' AND ofr.prtnum = '{2}' and (ct.desc_en like '{0}%' or ct.code like '{0}%') ORDER BY ct.desc_en limit 100
QUOTECOMMODITYTYPEFORRATES = SELECT ct.desc_en,ct.code,ct.hazmat,ct.id FROM other_db.ofrate  ofr left JOIN  commodity_type ct ON ofr.comcde = ct.code WHERE ofr.oabcod!='A' and ofr.trmnum = '{1}' AND ofr.prtnum = '{2}' and (ct.desc_en like '{0}%' or ct.code like '{0}%') and ct.code!='032500' ORDER BY ct.desc_en limit 100
QUOTECOMMODITYCODEFORRATES = SELECT ct.code,ct.desc_en,ct.hazmat,ct.id FROM other_db.ofrate  ofr left JOIN  commodity_type ct ON ofr.comcde = ct.code WHERE ofr.oabcod!='A' and ofr.trmnum = '{1}' AND ofr.prtnum = '{2}' and (ct.desc_en like '{0}%' or ct.code like '{0}%') and ct.code!='032500' ORDER BY ct.desc_en limit 100
CFCLCOMMODITY = SELECT ct.desc_en,ct.code,ct.hazmat,ct.id FROM commodity_type ct WHERE ct.code= 003600;

DISPOSITION = SELECT elite_code,description,id from disposition where elite_code like '{0}%' limit 50;

IMPORTWAREHOUSE=select concat(wh.warehsname, ' - ', wh.warehsno),wh.warehsname,wh.warehsno,CONCAT(wh.address,'\n',wh.city,', ',wh.state,' ',wh.zipcode),if(wh.city is null, '', wh.city),if(wh.state is null, '', wh.state),if(wh.zipcode is null, '', wh.zipcode),if(wh.phone is null, '',wh.phone),if(wh.fax is null, '',wh.fax),wh.id from warehouse wh where (wh.warehsno like '{0}%' or wh.warehsname like '{0}%') limit 50
IMPORTTERMINAL=SELECT CONCAT(t.terminal_location,'/',t.trmnum),t.terminal_location,t.trmnum,t.trmnam FROM terminal t WHERE t.actyon='F' AND (t.trmnum LIKE '{0}%' OR t.terminal_location LIKE '%{0}%') ORDER BY t.terminal_location LIMIT 50

#Units
BOOKED_VOYAGE=SELECT DISTINCT CONCAT(lsh.schedule_no,'/',DATE(lsd.std)),lsh.schedule_no,DATE_FORMAT(lsd.std,'%Y-%m-%d') FROM lcl_ss_header lsh JOIN lcl_ss_detail lsd ON lsd.ss_header_id=(SELECT ls.ss_header_id FROM lcl_ss_detail ls  WHERE ls.ss_header_id=lsh.id AND ls.trans_mode='V') WHERE lsh.origin_id='{1}' AND lsh.destination_id='{2}' AND lsh.schedule_no LIKE '{0}%' AND lsd.trans_mode='V' AND lsh.status <> 'V' AND lsd.std > NOW() ORDER BY lsd.std ASC LIMIT 50
BOOKED_UNITS=SELECT DISTINCT CONCAT(lsh.schedule_no,'/',DATE(lsd.std)),lsh.schedule_no,DATE_FORMAT(lsd.std,'%Y-%m-%d') FROM lcl_ss_header lsh JOIN lcl_ss_detail lsd ON lsd.ss_header_id=(SELECT ls.ss_header_id FROM lcl_ss_detail ls  WHERE ls.ss_header_id=lsh.id AND ls.trans_mode='V') WHERE lsh.origin_id='{1}' AND lsh.destination_id='{2}' AND lsh.service_type='{3}' AND lsh.schedule_no LIKE '{0}%' AND lsd.trans_mode='V' AND lsh.status <> 'V' AND lsd.std > NOW() ORDER BY lsd.std ASC LIMIT 50


ORG_WO_UNLOC=select distinct  concat(upper(ul.un_loc_name),'/',ifnull(upper(p.statecode),'')),upper(ul.un_loc_name) as portname,p.statecode as statecode,ul.un_loc_code  as unlocationcode,ul.id from lcl_relay_poo lrp inner join un_location ul on lrp.poo_id=ul.id inner join ports p on ul.un_loc_code=p.unlocationcode where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') and lrp.active = true group by ul.un_loc_code limit 50
PORT_WO_UNLOC=select distinct concat(upper(un.un_loc_name),'/',ifnull(upper(st.code),upper(ct.codedesc))),upper(un.un_loc_name),upper(un.statecode),un.un_loc_code,un.id from un_location un left join genericcode_dup st on st.id=un.statecode and st.Codetypeid=10 left join genericcode_dup ct on ct.id=un.countrycode and ct.Codetypeid=11 where un.un_loc_name like '{0}%' or un.search_un_loc_name like '{0}%' or upper(un.un_loc_code) like '{0}%' order by un.un_loc_name limit 50
DEST_WO_UNLOC=select distinct  concat(upper(ul.un_loc_name),'/',ifnull(upper(gd.code),upper(gc.codedesc))),upper(ul.un_loc_name) as portname,gc.codedesc as countryname,ul.un_loc_code as unlocationcode,ul.id from lcl_relay_fd lrf  inner join un_location ul on lrf.fd_id=ul.id inner join genericcode_dup gc on ul.countrycode=gc.id left join genericcode_dup gd on ul.statecode=gd.id where (ul.un_loc_name like '{0}%' or ul.search_un_loc_name like '{0}%' or ul.un_loc_code like '{0}%') group by ul.un_loc_code limit 1000


ORIGINTRM = SELECT DISTINCT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(st.code),UPPER(ct.codedesc)),'(',un.un_loc_code,')'),t.trmnum FROM un_location un LEFT JOIN genericcode_dup st ON st.id=un.statecode LEFT JOIN genericcode_dup ct ON ct.id=un.countrycode LEFT JOIN terminal t ON t.unlocationcode1=un.un_loc_code WHERE t.trmnum is NOT NULL and t.trmnum!="" and t.actyon='Y' AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR UPPER(un.un_loc_code) LIKE '{0}%') ORDER BY un.un_loc_name LIMIT 50
DESTTRM  =SELECT DISTINCT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(st.code),UPPER(ct.codedesc)),'(',un.un_loc_code,')'),t.eciportcode FROM un_location un LEFT JOIN genericcode_dup st ON st.id=un.statecode  LEFT JOIN genericcode_dup ct ON ct.id=un.countrycode LEFT JOIN ports t ON t.unlocationcode=un.un_loc_code WHERE  t.eciportcode IS NOT NULL AND t.eciportcode!="" AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR UPPER(un.un_loc_code) LIKE '{0}%') ORDER BY un.un_loc_name LIMIT 50

PORTCHARGECODE = SELECT UPPER(gl.Charge_code), UPPER(gl.bluescreen_chargecode), gl.id FROM gl_mapping gl WHERE gl.Charge_code LIKE '{0}%' AND Shipment_Type='LCLE' AND Transaction_Type='AR' GROUP BY gl.Charge_code ORDER BY gl.Charge_code LIMIT 10
LCL_SS_VOYAGE = SELECT CONCAT(lsh.schedule_no, '/', DATE(lsd.std)),lsh.schedule_no AS schNo,lsh.id AS headerId FROM lcl_ss_header lsh JOIN lcl_ss_detail lsd ON lsh.id=lsd.ss_header_id WHERE lsh.status <> 'V' AND lsh.schedule_no LIKE '{0}%' AND lsh.origin_id = '{1}' AND lsh.destination_id = '{2}' AND lsh.schedule_no != '{3}' AND service_type='{4}' AND lsd.std >SYSDATE() - INTERVAL 30 DAY ORDER BY lsd.std ASC LIMIT 20

UNIT_TYPE = SELECT description FROM unit_type WHERE description like '{0}%' LIMIT 50;

PORT_CITY_STATE=SELECT CONCAT(IFNULL(un.un_loc_name,''),'/',IFNULL(gdc.codedesc,''),'/',IFNULL(gds.code,''),'(',IFNULL(un.un_loc_code,''),')') as cityStateCountry,un.un_loc_name,gdc.codedesc,un.un_loc_code,gds.code FROM un_location un JOIN genericcode_dup gdc ON gdc.id=un.countrycode LEFT JOIN genericcode_dup gds ON gds.id=un.statecode WHERE (un.un_loc_code LIKE "{0}%" or un.un_loc_name LIKE "{0}%" or un.search_un_loc_name LIKE "{0}%") limit 100;

COUNTRY= SELECT DISTINCT  codedesc ,code  FROM genericcode_dup  WHERE codetypeid=11 AND (codedesc LIKE '{0}%' OR code LIKE '{0}%') ORDER BY codedesc

CONCAT_WITHOUT_US_COUNTRY=SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.codedesc),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.codedesc AS countryname,un.un_loc_code AS unlocationcode,gc.codedesc,un.id FROM un_location un JOIN genericcode_dup gc ON un.countrycode=gc.id WHERE un.un_loc_code NOT LIKE 'US%' AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%') LIMIT 1000;
CONCAT_WITH_US_STATE=SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.code),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.code AS stateCode,un.un_loc_code AS unlocationcode,gc.code,un.id FROM un_location un JOIN genericcode_dup gc ON un.statecode=gc.id WHERE (un.un_loc_code LIKE 'PR%' OR un.un_loc_code LIKE 'US%') AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%')Limit 1000;
SEARCH_BY_COUNTRY=SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.codedesc),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.codedesc AS countryname,un.un_loc_code AS unlocationcode,gc.codedesc,un.id FROM un_location un JOIN genericcode_dup gc ON un.countrycode=gc.id WHERE un.un_loc_code NOT LIKE 'US%' AND (gc.codedesc LIKE '{0}%') LIMIT 1000;
DEST_WITHOUT_US_COUNTRY=SELECT CONCAT(UPPER(un.un_loc_name),'/',IFNULL(UPPER(gc.codedesc),''),'(', un.un_loc_code,')') AS location,UPPER(un.un_loc_name) AS portname,gc.codedesc AS countryname,un.un_loc_code AS unlocationcode,un.id FROM un_location un JOIN genericcode_dup gc ON un.countrycode=gc.id WHERE un.un_loc_code NOT LIKE 'US%' AND (un.un_loc_name LIKE '{0}%' OR un.search_un_loc_name LIKE '{0}%' OR un.un_loc_code LIKE '{0}%') LIMIT 1000;

RATE_QUOTE = SELECT shipment_id FROM domestic_rate_quote LIMIT 50;
DOCK_RECEIPT = SELECT DISTINCT(lfn.file_number) FROM lcl_file_number lfn JOIN lcl_booking lb ON lfn.id=lb.file_number_id JOIN un_location pol ON pol.id=lb.pol_id JOIN un_location pod ON pod.id=lb.pod_id WHERE pol.un_loc_code='{1}' AND pod.un_loc_code='{2}' AND lb.booking_type IN('I','T') and lfn.status != 'X' and lfn.file_number LIKE '{0}%' ORDER BY lfn.id DESC;
USER_STATUS=SELECT UPPER(login_name), user_id FROM user_details WHERE  warehouse=TRUE LIMIT 100
ECULINE_UNIT = select cntr_name from container_info where cntr_name  like '{0}%' LIMIT 50
ECULINE_REFNO = select header_ref from eculine_edi where header_ref like '{0}%'
ECULINE_INVOICE_NO = select invoice_number from edi_invoice where invoice_number like '{0}%' group by invoice_number limit 50
ECULINE_CHARGE_DESC = SELECT DISTINCT replace(description, '\u2013', '&#8211;') FROM edi_invoice_detail WHERE search_description LIKE '{0}%' LIMIT 50
VOY_SCHEDULE_NO=SELECT schedule_no FROM lcl_ss_header WHERE schedule_no LIKE '{0}%' AND service_type='{1}' ORDER BY id DESC;
CFS_WAREHOUSE=select concat(wh.warehsname, ' - ', wh.warehsno),wh.warehsname,wh.warehsno,CONCAT(wh.address,'\n',wh.city,', ',wh.state,' ',wh.zipcode),if(wh.city is null, '', wh.city),if(wh.state is null, '', wh.state),if(wh.zipcode is null, '', wh.zipcode),if(wh.phone is null, '',wh.phone),if(wh.fax is null, '',wh.fax),wh.id from warehouse wh where (wh.warehsno like '{0}%' or wh.warehsname like '{0}%') AND wh.imports_cfs_devanning='Y' limit 50
IMPORTS_TP=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,co.code AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,CONCAT(cr.codedesc, '-', cr.id) AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') and type <> 'master' AND acct_type NOT LIKE '%Z%' GROUP BY acct_no LIMIT 50) AS tp LEFT JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
IMPORTS_TP_NOTE=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,sc.code AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,co.code AS commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,CONCAT(rc.code, ' ', rc.codedesc) AS retail_commodity,gi.id_text,cy.code AS country_code,gi.id_type,gi.duns_no,tp.forward_account,'',((SELECT COUNT(*) FROM other_db.cnnote WHERE actnum=tp.ecifwno AND autnot <> '*')+(SELECT COUNT(*) FROM other_db.ffnote WHERE actnum=tp.eci_acct_no AND autnot <> '*')) AS autonote,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no) AS custaddress,(SELECT COUNT(*) FROM cust_contact WHERE acct_no=tp.acct_no AND code_f IS NOT NULL AND code_f <> '') AS codesetup_f ,IF(scan.id IS NOT NULL ,'SOP','') AS scan_Sop,ar.import_credit FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_no LIKE '{0}%') AND acct_type NOT LIKE '%Z%' and type <> 'master' GROUP BY acct_no LIMIT 50) AS tp LEFT JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id LEFT JOIN document_store_log scan ON scan.`Document_ID`=tp.acct_no AND scan.screen_name = 'TRADINGPARTNER' AND scan.document_name = 'SOP' ORDER BY tp.acct_name
GENERICCODE_BY_IMONUMBER=SELECT codedesc,IF(field3!=0,field3,'') AS ImoNumber FROM genericcode_dup WHERE codetypeid = '{1}' AND codedesc LIKE '{0}%' ORDER BY codedesc LIMIT 100
COUNTRY_OF_US_CA=SELECT CONCAT(UPPER(ul.un_loc_name),'/',IFNULL(UPPER(p.statecode),''),'(', ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname, p.statecode AS statecode,ul.un_loc_code AS unlocationcode,ul.id FROM un_location ul INNER JOIN ports p ON p.`unlocationcode` = ul.`un_loc_code` WHERE (ul.un_loc_name LIKE '{0}%' OR ul.search_un_loc_name LIKE '{0}%' OR ul.`un_loc_code` LIKE '{0}%' ) AND (ul.`un_loc_code` LIKE 'CA%' OR  ul.`un_loc_code` LIKE 'US%') LIMIT 100;
VOYAGE_SCHEDULE_NO=SELECT ls.schedule_no AS voyageNo, ls.id AS headerId FROM lcl_ss_header ls  JOIN lcl_unit_ss lus   ON lus.`ss_header_id` = ls.`id` JOIN lcl_unit lu ON lu.`id`= lus.`unit_id` WHERE ls.schedule_no LIKE '{0}%' AND ls.service_type = 'E' AND ls.status NOT LIKE 'V' GROUP BY ls.id DESC LIMIT 50;
UNIT_NO = SELECT lu.`unit_no` AS unitNo, lu.`id` AS unitId FROM lcl_unit lu  JOIN lcl_unit_ss lss  ON lss.`unit_id` = lu.`id` JOIN lcl_ss_header lsh ON lsh.`id`= lss.`ss_header_id` WHERE lsh.id ='{1}';
SALES_PERSON_CODE = select ucase(`code`), ucase(`codedesc`) from `genericcode_dup` where `code` like '{0}%' and `codetypeid` = (select `codetypeid` from `codetype` where `description` = 'Sales Code' limit 1) limit 100
IMPORT_ORIGIN_AGENT=select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,concat(co.code, ' ', co.codedesc) as commodity,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,concat(cr.codedesc, '-', cr.id) as credit_status,concat(rc.code, ' ', rc.codedesc) as retail_commodity,gi.id_text,cy.code as country_code,gi.id_type,gi.duns_no from trading_partner tp join cust_address ca on tp.acct_no = ca.acct_no join  agency_info a on a.agentid=tp.acct_no join ports p on p.id = a.schnum left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id left join genericcode_dup co on gi.cons_coload_commodity = co.id left join genericcode_dup rc on gi.cons_retail_commodity = rc.id left join cust_accounting ar on tp.acct_no = ar.acct_no left join genericcode_dup cr on ar.credit_status = cr.id where (tp.acct_name like '{0}%' or tp.search_acct_name like '{0}%' or a.agentid like '{0}%') and a.type='I' group by tp.acct_no limit 100
#Fcl Rate Report
FCL_RATE_COMMODITY=SELECT codedesc,CODE FROM genericcode_dup WHERE codetypeid='4'  AND (codedesc LIKE '{0}%' OR code LIKE '{0}%');
FCL_RATE_SSLINE=select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,sc.code as sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%' or ssline_number like '{0}%') and ssline_number <>'' and acct_type like '%V%' and sub_type = 'Steamship Line' order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no
FCL_RATE_ORIGIN=SELECT CONCAT(UPPER(p.portname),'/',IFNULL(UPPER(p.statecode), ''),'(',p.unlocationcode,')'),p.govschnum FROM ports p WHERE p.regioncode IN (SELECT id FROM genericcode_dup WHERE CODE IN (09,10,11) ORDER BY codedesc) AND (p.search_port_name LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' OR p.govschnum LIKE '{0}%') AND p.govschnum <> '' LIMIT 50
FCL_RATE_DESTINATION=SELECT CONCAT(UPPER(p.portname),'/',gd.codedesc,'(',p.unlocationcode,')'),p.govschnum FROM ports p JOIN un_location un ON un.un_loc_code=p.unlocationcode JOIN genericcode_dup gd ON gd.id=un.countrycode WHERE p.regioncode IN(SELECT id FROM genericcode_dup WHERE CODE NOT IN (09,10,11) ORDER BY codedesc) AND (p.search_port_name LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' OR p.govschnum LIKE '{0}%') AND p.govschnum <> '' GROUP BY un.un_loc_code LIMIT 50


#LCL Exports
EXP_CLIENT_NO_CONSIGNEE=SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,tp.forward_account,cc.code AS coloadComNo,cc.codedesc AS coloadComDesc,rc.code AS retailComNo,rc.codedesc AS retailComDesc,tp.brand_preference AS brand  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account,brand_preference  FROM trading_partner WHERE ((acct_no LIKE '{0}%' OR search_acct_name LIKE '{0}%' OR acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%' OR acct_type!='C')) AND TYPE <> 'master' GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup cc ON gi.commodity_no = cc.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_no
EXP_CLIENT_WITH_CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,  CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,tp.forward_account,cc.code AS coloadComNo,cc.codedesc AS coloadComDesc,rc.code AS retailComNo,rc.codedesc AS retailComDesc,tp.brand_preference AS brand FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account,brand_preference FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder') OR acct_type LIKE '%O%' OR acct_type='C') GROUP BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup cc ON gi.commodity_no = cc.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id ORDER BY tp.acct_name
SHIPPER	= SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,  CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',' ,'\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,tp.forward_account,co.code AS shpcoloadNo,co.codedesc AS shpColoadDesc,rc.code AS shpRetailNo,rc.codedesc AS shpRetailDesc,ar.credit_limit AS creditLimit,tp.brand_preference AS brand FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account,brand_preference FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND (acct_type LIKE '%S%' OR (acct_type LIKE '%V%' AND sub_type='Forwarder')) AND acct_type NOT LIKE '%Z%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
FORWARDER = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,  CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,tp.forward_account,co.code AS fwdcoloadNo,co.codedesc AS fwdColoadDesc,rc.code AS fwdRetailNo,rc.codedesc AS fwdRetailDesc,tp.brand_preference AS brand  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account,brand_preference FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND acct_type LIKE '%V%' AND acct_type NOT LIKE '%Z%' AND sub_type='Forwarder' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.commodity_no = co.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
EXP_CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number, CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,ar.credit_limit,tp.forward_account,co.code AS consColoadNo,co.codedesc AS consColoadDesc,rc.code AS consRetailNo,rc.codedesc AS consRetailDesc  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND acct_type LIKE '%C%' AND acct_type NOT LIKE '%Z%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
EXP_CONSIGNEE_BL = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number, CONCAT(sc.code, '(', sc.`codedesc`,')') AS sales_person,tp.disabled,IF(ca.co_name IS NULL OR ca.co_name = '', ca.address1, CONCAT(ca.co_name,',','\n',ca.address1)) AS address,ca.city1 AS city,ca.state,cy.codedesc AS country,ca.zip,ca.contact_name,ca.phone,ca.fax,ca.email1,gi.fw_fmc_no,gi.nvo_oti_license_no,gi.poa,cr.codedesc AS credit_status,cy.code AS country_code,ar.credit_limit,tp.forward_account,co.code AS consColoadNo,co.codedesc AS consColoadDesc,rc.code AS consRetailNo,rc.codedesc AS consRetailDesc  FROM (SELECT acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled,forward_account FROM trading_partner WHERE (acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%') AND acct_type LIKE '%C%' AND acct_type NOT LIKE '%Z%' ORDER BY acct_no LIMIT 50) AS tp JOIN cust_address ca ON (tp.acct_no = ca.acct_no AND ca.prime = 'on') LEFT JOIN genericcode_dup cy ON ca.country = cy.id LEFT JOIN cust_general_info gi ON tp.acct_no = gi.acct_no LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id LEFT JOIN genericcode_dup co ON gi.cons_coload_commodity = co.id LEFT JOIN genericcode_dup rc ON gi.cons_retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup cr ON ar.credit_status = cr.id GROUP BY tp.acct_no
WAREHOUSE_WITH_WHSENUMBER = SELECT wh.warehsno,wh.warehsname,wh.id,wh.address,wh.city,wh.state,wh.zipcode,wh.phone FROM warehouse wh WHERE  wh.warehsno <> '' AND (wh.warehsno LIKE '{0}%'  OR wh.warehsname LIKE '{0}%') ORDER BY wh.warehsname LIMIT 100;
WAREHOUSE_WITH_WHSENAME = SELECT wh.warehsno,wh.warehsname,wh.id,wh.address,wh.city,wh.state,wh.zipcode,wh.phone FROM warehouse wh WHERE  wh.warehsno <> '' AND (wh.warehsno LIKE '{0}%'  OR wh.warehsname LIKE '{0}%') ORDER BY wh.warehsname LIMIT 100;
Un_Assign_Unit_No =SELECT UCASE(lu.unit_no) FROM lcl_unit lu JOIN lcl_unit_whse lw ON lu.`id` = lw.`unit_id` WHERE lw.`ss_header_id` IS NULL AND lw.id= (SELECT id FROM lcl_unit_whse  lw WHERE lu.`id` = lw.`unit_id` ORDER BY lw.id DESC LIMIT 1) AND lw.`warehouse_id` = {1} AND lw.`ss_header_id` IS  NULL;
EXPORT_SSLINE = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') and acct_type like '%V%' AND ssline_number <> '' AND  ssline_number <> '00000' order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no;
VOYAGE_NO_EXPORT=SELECT ls.schedule_no AS voyageNo, ls.id AS headerId, dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination FROM lcl_ss_header ls JOIN un_location dep ON dep.`id` = ls.`origin_id` JOIN un_location arr ON arr.id = ls.`destination_id` WHERE ls.schedule_no LIKE '{0}%' AND ls.service_type = 'E' AND ls.status NOT LIKE 'V' GROUP BY ls.id DESC LIMIT 50;
VOYAGE_NO_INLAND=SELECT ls.schedule_no AS voyageNo, ls.id AS headerId,dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination  FROM lcl_ss_header ls JOIN un_location dep ON dep.`id` = ls.`origin_id` JOIN un_location arr ON arr.id = ls.`destination_id`  WHERE ls.schedule_no LIKE '{0}%'AND ls.service_type = 'N' AND ls.status NOT LIKE 'V' GROUP BY ls.id DESC LIMIT 50;
VOYAGE_NO_CFCL=SELECT ls.schedule_no AS voyageNo, ls.id AS headerId,dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination  FROM lcl_ss_header ls JOIN un_location dep ON dep.`id` = ls.`origin_id` JOIN un_location arr ON arr.id = ls.`destination_id` WHERE ls.schedule_no LIKE '{0}%' AND ls.service_type = 'C' AND ls.status NOT LIKE 'V' GROUP BY ls.id DESC LIMIT 50;
EXPORT_CONCAT_PORTS =select concat(upper(p.portname),'/', ifnull(upper(gd.code),upper(g.codedesc)),'(', p.unlocationcode,')') as location,upper(p.portname), upper(p.countryname), p.unlocationcode,p.id from ports p left join un_location u1 on u1.id=p.id left join genericcode_dup g on g.id=u1.countrycode left join genericcode_dup gd on gd.id=u1.statecode  where (p.portname like '{0}%' or p.unlocationcode like '{0}%' or p.search_port_name like '{0}%') and  p.`pierabbr` <> ''   group by location order by p.portname limit 100;
RELAY_ORIGIN=SELECT CONCAT(UPPER(ul.un_loc_name),'/',IFNULL(UPPER(p.statecode),''),'(', ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname,p.statecode AS statecode,ul.un_loc_code  AS unlocationcode,ul.id FROM un_location ul INNER JOIN ports p ON ul.un_loc_code=p.unlocationcode  WHERE (ul.un_loc_name LIKE '{0}%' OR ul.search_un_loc_name LIKE '{0}%' OR ul.un_loc_code LIKE '{0}%')  AND ul.lcl_export_service = TRUE GROUP BY ul.un_loc_code LIMIT 50 ; 
RELAY_VOY=SELECT CONCAT(UPPER(ul.un_loc_name),'/',IFNULL(UPPER(p.statecode),''),'(', ul.un_loc_code,')'),UPPER(ul.un_loc_name) AS portname,p.statecode AS statecode,ul.un_loc_code  AS unlocationcode,ul.id FROM un_location ul INNER JOIN ports p ON ul.un_loc_code=p.unlocationcode WHERE (ul.un_loc_name LIKE '{0}%' OR ul.search_un_loc_name LIKE '{0}%' OR ul.un_loc_code LIKE '{0}%') GROUP BY ul.un_loc_code LIMIT 50;
EXPORT_LAND_CARRIER = select tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no as bs_ship_fwd_no,tp.ecifwno as bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 as address,ca.city1 as city,ca.state,cy.codedesc as country,ca.zip from (select acct_name,acct_no,acct_type,sub_type,eci_acct_no,ecifwno,ssline_number,disabled from trading_partner where (acct_no like '{0}%' or acct_name like '{0}%' or search_acct_name like '{0}%') AND acct_type LIKE '%V%' AND ( ssline_number <> '' OR  ssline_number <> '00000' OR sub_type = 'Trucker' ) order by acct_no limit 50) as tp join cust_address ca on tp.acct_no = ca.acct_no and ca.prime='on' left join genericcode_dup cy on ca.country = cy.id left join cust_general_info gi on tp.acct_no = gi.acct_no left join genericcode_dup sc on gi.sales_code = sc.id group by tp.acct_no;
QUICKDR_CONSIGNEE = SELECT tp.acct_name,tp.acct_no,tp.acct_type,tp.sub_type,tp.eci_acct_no AS bs_ship_fwd_no,tp.ecifwno AS bs_cons_no,tp.ssline_number,CONCAT(sc.code, '(', sc.codedesc,')') AS sales_person,tp.disabled,ca.address1 AS address,ca.city1 AS city,ca.state,cy.codedesc AS country, ca.zip, ca.contact_name,ca.phone, ca.fax, ca.email1, gi.fw_fmc_no, gi.nvo_oti_license_no, gi.poa,cr.codedesc AS credit_status,cy.code AS country_code, tp.forward_account,cc.code AS coloadComNo,  cc.codedesc AS coloadComDesc,  rc.code AS retailComNo,  rc.codedesc AS retailComDesc FROM  (SELECT acct_name, acct_no, acct_type, sub_type, eci_acct_no, ecifwno, ssline_number, disabled, forward_account FROM  trading_partner WHERE ( acct_no LIKE '{0}%' OR acct_name LIKE '{0}%' OR search_acct_name LIKE '{0}%'  )    AND acct_type LIKE '%C%' GROUP BY acct_no  LIMIT 50) AS tp  JOIN cust_address ca  ON (tp.acct_no = ca.acct_no   AND ca.prime = 'on' )  LEFT JOIN genericcode_dup cy   ON ca.country = cy.id  LEFT JOIN cust_general_info gi  ON tp.acct_no = gi.acct_no  LEFT JOIN genericcode_dup sc ON gi.sales_code = sc.id  LEFT JOIN genericcode_dup cc  ON gi.commodity_no = cc.id LEFT JOIN genericcode_dup rc ON gi.retail_commodity = rc.id LEFT JOIN cust_accounting ar ON tp.acct_no = ar.acct_no LEFT JOIN genericcode_dup ic ON gi.imp_comm_no = ic.id LEFT JOIN genericcode_dup cr  ON ar.credit_status = cr.id ORDER BY tp.acct_name 
UNIT_NO_EXPORT=SELECT lu.unit_no, lsh.schedule_no AS voyageNo, lsh.id AS headerId, dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination FROM lcl_unit lu  JOIN lcl_unit_ss lus  ON lus.unit_id = lu.id JOIN lcl_ss_header lsh ON lsh.id = lus.ss_header_id  JOIN un_location dep ON dep.`id` = lsh.`origin_id` JOIN un_location arr ON arr.id = lsh.`destination_id` WHERE lu.unit_no LIKE '{0}%' AND lsh.service_type = 'E' GROUP BY lsh.id DESC LIMIT 50;
UNIT_NO_INLAND=SELECT lu.unit_no, lsh.schedule_no AS voyageNo, lsh.id AS headerId, dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination FROM lcl_unit lu  JOIN lcl_unit_ss lus  ON lus.unit_id = lu.id JOIN lcl_ss_header lsh ON lsh.id = lus.ss_header_id  JOIN un_location dep ON dep.`id` = lsh.`origin_id` JOIN un_location arr ON arr.id = lsh.`destination_id` WHERE lu.unit_no LIKE '{0}%' AND lsh.service_type = 'N' GROUP BY lsh.id DESC LIMIT 50;
UNIT_NO_CFCL=SELECT lu.unit_no, lsh.schedule_no AS voyageNo, lsh.id AS headerId, dep.`un_loc_name` AS origin, arr.`un_loc_name` AS destination FROM lcl_unit lu  JOIN lcl_unit_ss lus  ON lus.unit_id = lu.id JOIN lcl_ss_header lsh ON lsh.id = lus.ss_header_id  JOIN un_location dep ON dep.`id` = lsh.`origin_id` JOIN un_location arr ON arr.id = lsh.`destination_id` WHERE lu.unit_no LIKE '{0}%' AND lsh.service_type = 'C' GROUP BY lsh.id DESC LIMIT 50;

EXP_UNIT_SEARCH=SELECT lu.unit_no,lu.id ,(SELECT IF(COUNT(*)>1,TRUE,FALSE) FROM lcl_unit_ss lus JOIN lcl_ss_header ls ON ls.id=lus.ss_header_id WHERE lus.unit_id=lu.id) AS result,lsh.origin_id,UnLocationGetNameStateCntryByID(lsh.origin_id),lsh.destination_id,UnLocationGetNameStateCntryByID(lsh.destination_id),lsh.schedule_no FROM lcl_unit lu JOIN lcl_unit_ss luss ON luss.unit_id=lu.id JOIN lcl_ss_header lsh ON lsh.id=luss.ss_header_id WHERE lu.unit_no LIKE '{0}%' GROUP BY lu.id LIMIT 50;
EXP_VOYAGE_SEARCH=SELECT ls.schedule_no AS voyageNo,ls.origin_id,UnLocationGetNameStateCntryByID(ls.origin_id),ls.destination_id,UnLocationGetNameStateCntryByID(ls.destination_id) FROM lcl_ss_header ls WHERE ls.schedule_no LIKE '{0}%' AND ls.status <> 'V' GROUP BY ls.id DESC LIMIT 50;
EXP_BOOKING_NO_SEARCH=SELECT lmb.sp_booking_no AS bookingNo ,(SELECT IF(COUNT(*)>1,TRUE,FALSE)  FROM  lcl_ss_masterbl lm WHERE lmb.`sp_booking_no` = lm.sp_booking_no) AS result,ls.origin_id,UnLocationGetNameStateCntryByID(ls.origin_id),ls.destination_id,UnLocationGetNameStateCntryByID(ls.destination_id),ls.schedule_no FROM  lcl_ss_masterbl lmb JOIN lcl_ss_header ls ON ls.id=lmb.ss_header_id WHERE lmb.`sp_booking_no` LIKE '{0}%'  GROUP BY  lmb.sp_booking_no;
EXPORT_CONCAT_PORTS1=SELECT CONCAT(UPPER(p.portname),'/', IFNULL(UPPER(gd.code),UPPER(g.codedesc)),'(', p.unlocationcode,')') AS location,UPPER(p.portname), UPPER(p.countryname), p.unlocationcode,p.id FROM ports p LEFT JOIN un_location u1 ON u1.id=p.id LEFT JOIN genericcode_dup g ON g.id=u1.countrycode LEFT JOIN genericcode_dup gd ON gd.id=u1.statecode  WHERE ((p.search_port_name LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' OR p.portname LIKE '{0}%') AND (p.`countryname` = 'UNITED STATES' OR p.`countryname` = 'CANADA')) AND  p.`pierabbr` <> '' GROUP BY location ORDER BY p.portname LIMIT 100;
US_CANADA_CITY=SELECT CONCAT(UPPER(p.portname),'/', IFNULL(UPPER(gd.code),UPPER(g.codedesc)),'(', p.unlocationcode,')') AS location,UPPER(p.portname), UPPER(p.countryname), p.unlocationcode,p.id FROM ports p LEFT JOIN un_location u1 ON u1.id=p.id LEFT JOIN genericcode_dup g ON g.id=u1.countrycode LEFT JOIN genericcode_dup gd ON gd.id=u1.statecode  WHERE ((p.search_port_name LIKE '{0}%' OR p.unlocationcode LIKE '{0}%' OR p.portname LIKE '{0}%') AND (p.`countryname` = 'UNITED STATES' OR p.`countryname` = 'CANADA')) ORDER BY p.portname LIMIT 100;
EXPORT_DELIVER_CARGO=SELECT warehsno,warehsname,address,city,state,zipcode,phone,fax ,id FROM warehouse WHERE (warehsno LIKE '{0}%' OR warehsname LIKE '{0}%') AND warehsno LIKE '{0}%' LIMIT 50;
WAREHOUSE_ACTIVATE_LOGINNAME =SELECT CONCAT(first_name,' ',last_name) , warehouse_emplid, user_id AS userId FROM `user_details` WHERE warehouse IS TRUE AND (first_name LIKE '{0}%' OR last_name LIKE '{0}%' OR warehouse_emplid LIKE '{0}%')  LIMIT 50;
PICKED_DR_FOR_CONSOLIDATION = SELECT distinct lf.`file_number` , lf.`id`, lf.state, (SELECT COUNT(*) FROM lcl_consolidation lg WHERE lg.lcl_file_number_id_b  = lf.id) AS consCount  FROM lcl_unit_ss lus  JOIN lcl_booking_piece_unit bu ON bu.`lcl_unit_ss_id` = lus.`id`  JOIN lcl_booking_piece bp ON bp.id=bu.`booking_piece_id` JOIN lcl_booking b ON b.`file_number_id` = bp.file_number_id JOIN lcl_file_number lf ON lf.`id` = b.`file_number_id`  JOIN `lcl_consolidation` lc ON (lc.`lcl_file_number_id_a` = lf.`id` AND  lc.`lcl_file_number_id_a` = lc.`lcl_file_number_id_b`)  WHERE b.`pod_id` = '{1}' AND b.`fd_id` = '{2}'  and  lf.id <> '{3}' and lf.`file_number`  LIKE '{0}%'  HAVING consCount = 1  order by lf.id desc;
#UnitNo
UNIT_NO=SELECT CONCAT(lu.unit_no,'/',ut.description),lu.unit_no,lu.id FROM lcl_unit lu JOIN unit_type ut ON ut.id=lu.unit_type_id WHERE lu.unit_no LIKE '{0}%' AND lu.unit_no <> '{1}' LIMIT 100
BL_POSTED_FILES=SELECT fn.file_number,fn.id FROM lcl_file_number fn JOIN lcl_bl AS  bl ON fn.id = bl.file_number_id JOIN lcl_booking b ON b.file_number_id=fn.id WHERE fn.status NOT IN('M','T') AND fn.state='BL' AND bl.posted_datetime <> '' AND fn.file_number LIKE '{0}%' AND  b.pol_id='{1}' AND b.pod_id='{2}' LIMIT 100
BL_PICKED_UNIT=SELECT fn.file_number,fn.id FROM lcl_booking_piece_unit bpu JOIN lcl_booking_piece bp ON bp.id = bpu.booking_piece_id JOIN lcl_file_number fn ON fn.id = bp.file_number_id WHERE fn.state='BL' AND fn.status='M' AND bpu.lcl_unit_ss_id ='{1}' AND fn.file_number LIKE '{0}%' GROUP BY fn.id
BOOKING_UNRELEASED_FILES=SELECT CASE WHEN fn.short_ship != 0 THEN CONCAT('ZZ',fn.short_ship_sequence,'-',fn.file_number) ELSE fn.file_number END AS file_number,fn.id FROM lcl_file_number fn  JOIN lcl_booking b ON b.file_number_id=fn.id JOIN lcl_booking_export AS  bl ON fn.id = bl.file_number_id WHERE fn.status NOT IN('X')  AND bl.released_datetime is null AND fn.file_number LIKE '{0}%'  LIMIT 100
HBL_DR =SELECT fn.fNo,fn.fId FROM (SELECT lcf.file_number AS fNo, lcf.id  AS fId FROM lcl_ss_header lsh  LEFT JOIN lcl_unit_ss lus ON lsh.id = lus.ss_header_id LEFT JOIN lcl_booking_piece_unit lbp  ON lbp.lcl_unit_ss_id = lus.id LEFT JOIN lcl_booking_piece bp  ON bp.id = lbp.booking_piece_id  LEFT JOIN lcl_file_number lcf  ON lcf.id = bp.file_number_id  WHERE lcf.file_number LIKE '{0}%' AND lsh.id = '{1}'  AND lcf.state = 'BL' UNION SELECT lcf.file_number AS fNo, con.`lcl_file_number_id_b` AS fId FROM  lcl_ss_header lsh  LEFT JOIN lcl_unit_ss lus  ON lsh.id = lus.ss_header_id LEFT JOIN lcl_booking_piece_unit lbp  ON lbp.lcl_unit_ss_id = lus.id LEFT JOIN lcl_booking_piece bp  ON bp.id = lbp.booking_piece_id  LEFT JOIN lcl_file_number lcf  ON lcf.id = bp.file_number_id LEFT JOIN lcl_consolidation con  ON con.`lcl_file_number_id_a` = lcf.id AND con.lcl_file_number_id_b <> con.lcl_file_number_id_a WHERE lcf.file_number LIKE '{0}%'  AND lsh.id = '{1}'  AND lcf.state = 'BL' AND con.lcl_file_number_id_b IS NOT NULL) fn LEFT JOIN lcl_bl bl ON bl.`file_number_id` = fn.fId WHERE fn.fId IS NOT NULL AND bl.`posted_by_user_id` IS NOT NULL ORDER BY fn.fNo
