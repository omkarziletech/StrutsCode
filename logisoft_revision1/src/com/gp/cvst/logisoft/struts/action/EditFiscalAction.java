/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.gp.cvst.logisoft.struts.action;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;



import com.gp.cvst.logisoft.beans.FiscalPeriodBean;
import com.gp.cvst.logisoft.struts.form.EditFiscalForm;

/** 
 * MyEclipse Struts
 * Creation date: 05-26-2008
 * 
 * XDoclet definition:
 * @struts.action path="/editfiscal" name="editFisaclForm" input="/jsps/Accounting/FiscalCalender.jsp" scope="request"
 */
public class EditFiscalAction extends Action {
    /*
     * Generated Methods
     */

    /**
     * Method execute
     * @param mapping
     * @param form
     * @param request
     * @param response
     * @return ActionForward
     */
    public ActionForward execute(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response)throws Exception {
        EditFiscalForm editFisaclForm = (EditFiscalForm) form;// TODO Auto-generated method stub

        HttpSession session = ((HttpServletRequest) request).getSession();
        /*FiscalPeriod fisdomain=new FiscalPeriod();
        FiscalPeriodDAO fisDAO=new FiscalPeriodDAO();
        FiscalPeriodBean fisbean=new FiscalPeriodBean();*/
        String forwardName = "";
        String buttonValue = editFisaclForm.getButtonValue();
        String Fisperiod1 = editFisaclForm.getFiscalperiod();
        int Fisperiod11 = Integer.parseInt(Fisperiod1);

        Fisperiod11--;
        String Startingdate1 = editFisaclForm.getStartingdate1();
        String Endingdate1 = editFisaclForm.getEndingdate1();
        String fisperiod1 = editFisaclForm.getFisperiod1();
        //int fisperiod11=Integer.parseInt(fisperiod1);
        String year = editFisaclForm.getYear();

        //int fs2=Integer.parseInt(Fisperiod1);
        int z = 0;
        /*String fiscal="";
        String stdate="";
        String eadate="";
        String fs1="";
        String sd1="";
        String ed1="";
        String Fisperiod2="";
        String Startingdate2="";
        String Endingdate2="";*/
        /*List d=null;
        List fp1BeanList=null;
        List fpBeanList=null;*/
        List valuebeans = null;
        List listedvalues = null;
        List abcd = new ArrayList();
        /*List editlist=null;
        List savevalues=null;
        Date date = null;
        Date date2=null;*/
        Date date = null;
        Date date2 = null;
        DateFormat format = null;


        if (buttonValue.equals("update")) {

            valuebeans = (List) session.getAttribute("abc");
            if (session.getAttribute("abc") != null) {
                listedvalues = (List) session.getAttribute("abc");
            }
            listedvalues.get(z);

            int i = valuebeans.size();
            while (z < 12) {
                if (Fisperiod11 == z) {
                    FiscalPeriodBean fisbean1 = (FiscalPeriodBean) valuebeans.get(z);
                    fisbean1.setYear(year);
                    fisbean1.setPeriod(fisperiod1);
                    fisbean1.setStaringdate(Startingdate1);

                    fisbean1.setEndingdate(Endingdate1);
                    // fisbean1.setYear(year);

                    abcd.add(fisbean1);
                    session.setAttribute("fisperiod1", fisperiod1);
                    session.setAttribute("Startingdate1", Startingdate1);
                    session.setAttribute("Endingdate1", Endingdate1);
                    format = new SimpleDateFormat("MM/dd/yyyy");
                        date = (Date) format.parse(Startingdate1);

                        date2 = (Date) format.parse(Endingdate1);
                    fisbean1 = null;
                } else {
                    FiscalPeriodBean fisbean1 = (FiscalPeriodBean) valuebeans.get(z);
                    abcd.add(fisbean1);
                    fisbean1 = null;
                }
                z++;
            }// while(z<12)
        }//if

        session.setAttribute("savevalues", abcd);
        request.setAttribute("buttonValue", "completed");
        session.setAttribute("abc", abcd);
        session.setAttribute("year", year);
        //session.setAttribute("searchlist",abcd);

        forwardName = "success";

        return mapping.findForward(forwardName);

    }
}