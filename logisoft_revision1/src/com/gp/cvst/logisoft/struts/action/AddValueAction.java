/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.gp.cvst.logisoft.struts.action;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;

import com.gp.cvst.logisoft.domain.SegmentValues;
import com.gp.cvst.logisoft.hibernate.dao.SegmentDAO;
import com.gp.cvst.logisoft.hibernate.dao.SegmentValuesDAO;
import com.gp.cvst.logisoft.struts.form.AddValueForm;


/** 
 * MyEclipse Struts
 * Creation date: 06-18-2008
 * 
 * XDoclet definition:
 * @struts.action path="/addvalue" name="AddValueForm" input="/jsps/Accounting/AddValuePopup.jsp" scope="request"
 */
public class AddValueAction extends Action {
	/*
	 * Generated Methods
	 */

	/** 
	 * Method execute
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward execute(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
		AddValueForm addSegmentForm = (AddValueForm) form;
		    HttpSession session = ((HttpServletRequest)request).getSession();
			 SegmentValuesDAO segvalDAO = new SegmentValuesDAO();
			 SegmentDAO segmentdao = new SegmentDAO();
			 SegmentValues segmentdomain=new SegmentValues();
			 List segList =new ArrayList();
			 String forwardName=""; 
			 String buttonValue=addSegmentForm.getButtonValue();		   
			 String addsegcode=addSegmentForm.getAddcode();
			 String addsegdesc=addSegmentForm.getAdddesc();
			 String segcodeid=addSegmentForm.getSegcodeId();
			 String id=addSegmentForm.getId();
			 String segcode = addSegmentForm.getSegcode();
			 String segLength=addSegmentForm.getSeglength();
			int segvalId=Integer.parseInt(id);
			String segid="";
		if(buttonValue.equals("segmentValues")){
		    segid = segmentdao.selectAccountCodeid(segvalId, segcode);
		    segmentdomain.setSegmentValueDesc(addsegdesc);
		    segmentdomain.setSegmentValue(addsegcode);
			segmentdomain.setSegmentCodeId(segcodeid);
			segmentdomain.setSegmentCodeId(segid);
		    segList.add(segmentdomain);
			List segcodes=(List)segvalDAO.comparevalue(segid);
			List addvaluelist=null;
			 if(!segcodes.contains(addsegcode)){
			     segvalDAO.saveSegmentValues(segmentdomain);
			     String valueid= (String)segmentdao.selectsegid(id,segcode); 
			     addvaluelist = (List)segvalDAO.listsegvalues(valueid);
			     session.setAttribute("addvaluelist",addvaluelist);
				 }
			  else{
				 String msg="Please enter different Segment Value, This Segment Value already exists";
				 request.setAttribute("message",msg);
				}
			 request.setAttribute("segcode",segcode);
			 request.setAttribute("seglength", segLength);
			 request.setAttribute("ActStructId1",id);
				forwardName="success";
		}
		
				session.setAttribute("segList",segList);
				return mapping.findForward(forwardName);
	}
}
			